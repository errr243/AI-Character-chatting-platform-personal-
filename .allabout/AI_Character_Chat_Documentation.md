# AI 캐릭터 채팅 애플리케이션 - 문서

## 프로젝트 개요

이 프로젝트는 Gemini AI 기반의 캐릭터 채팅 플랫폼입니다. 폴더 이름이 "Translator"이지만 실제로는 고급 AI 캐릭터 채팅 플랫폼으로, Next.js로 구축되었습니다.

**프로젝트 이름:** AI 캐릭터 채팅 (ai-character-chat)

**설명:** Google의 Gemini AI 모델을 기반으로 한 고급 캐릭터 기반 채팅 플랫폼으로, 사용자가 개인화된 AI 캐릭터를 생성하고 상호작용할 수 있게 합니다.

## 주요 기능

### 1. 캐릭터 관리 시스템
- **사용자 정의 캐릭터 생성**: 이름, 성격, 관계, 대화 스타일을 사용자 정의할 수 있음
- **캐릭터 매개변수**:
  - 1인칭/2인칭 대명사
  - 대화 스타일 (예: 사적인 반말)
  - 관계 유형 (친구, 직장 동료 등)
  - 배경 스토리
  - 성격 특징 및 속성
  - 대화 안전 규칙

### 2. 고급 채팅 기능
- **AI 기반 대화**: Google의 Gemini AI 모델(gemini-pro, gemini-flash) 지원
- **문맥 인식 응답**: 대화 전체에서 캐릭터 성격과 문맥 유지
- **메시지 기록**: 전체 대화 기록 및 메시지 편집 가능
- **메시지 재생성**: "다시 생성" 기능으로 AI 응답을 다시 생성
- **실시간 상호작용**: 타이핑 인디케이터와 즉각적인 응답

### 3. 메모리 및 문맥 시스템
- **대화 요약**: 대화 문맥을 유지하기 위한 자동 요약
- **수동 요약**: 사용자 시작 요약 기능
- **메모리 모달**: 접근 가능한 메모리 시스템으로 대화 문맥 표시
- **문맥 보존**: 세션 간 대화 문맥 유지

### 4. 채팅 기록 관리
- **다중 채팅 지원**: 여러 독립된 대화 생성 및 관리
- **제목 관리**: 식별을 위한 편집 가능한 채팅 제목
- **기록 유지**: 로컬 저장소 기반 채팅 기록 보존
- **선택적 기록 로드**: 긴 대화를 위한 효율적인 메모리 관리

### 5. 고급 설정
- **출력 속도 제어**: 즉시, 빠르게, 느리게 응답 렌더링
- **토큰 관리**: 최대 출력 토큰 설정 (최대 8192)
- **생각 예산**: 조절 가능한 AI 생각 기능
- **로어북 통합**: 키워드 감지를 통한 문맥 정보 검색
- **UI 스타일 옵션**: 모던 또는 클래식 인터페이스 테마

### 6. 다중 플랫폼 지원
- **반응형 디자인**: 데스크톱 및 모바일 친화적 인터페이스
- **모바일 최적화**: 하단 네비게이션을 포함한 특별 모바일 UI
- **크로스 플랫폼**: 모든 현대 브라우저 및 장치에서 작동

### 7. 데이터 관리
- **가져오기/내보내기**: 전체 데이터 백업 및 복원 기능
- **로컬 저장소**: 브라우저의 로컬 저장소에 모든 데이터 저장
- **API 키 관리**: 할당량 추적과 함께 보안 클라이언트 측 API 키 저장

## 아키텍처 및 기술 구성 요소

### 기술 스택
- **프론트엔드 프레임워크**: Next.js 16
- **런타임**: React 19.2.0
- **스타일링**: Tailwind CSS와 사용자 정의 CSS 변수
- **UI 컴포넌트**: Lucide React 아이콘과 사용자 정의 컴포넌트
- **상태 관리**: React 훅 (useState, useEffect, useRef 등)
- **마크다운 지원**: 구문 강조와 함께 React Markdown
- **프로그레시브 웹 앱**: 오프라인 기능을 위한 Next PWA

### 핵심 아키텍처 구성 요소

#### 1. API 통합 레이어
- `/api/chat`: AI 대화 요청 처리
- `/api/summarize`: 대화 요약 관리
- `/api/characters`: 캐릭터 관리 엔드포인트
- 다중 API 키 지원과 자동 장애 조치

#### 2. 클라이언트 라이브러리
- **Gemini 클라이언트**: Google의 Gemini API와의 AI 상호작용 처리
- **저장소 시스템**: 로컬 저장소 기반 데이터 지속성
- **프롬프트 빌더**: 역동적 캐릭터 프롬프트 생성 시스템
- **타입 정의**: 모든 데이터 구조에 대한 엄격한 TypeScript 인터페이스

#### 3. 컴포넌트 구조
- **채팅 컴포넌트**: 사이드바, 채팅 영역, 설정 패널
- **모바일 컴포넌트**: 모바일 최적화 UI와 드로어 네비게이션
- **UI 컴포넌트**: 일관된 스타일의 재사용 가능한 UI 요소
- **모달 컴포넌트**: 메모리 모달, 설정 패널

#### 4. 상태 관리
- **글로벌 상태**: 채팅, 캐릭터, 기록 관리
- **로컬 상태**: 개별 컴포넌트 상태
- **지속성**: 로컬 저장소 동기화
- **디바운싱**: 지나친 쓰기를 방지하기 위한 최적화된 저장 작업

## API 통합 및 AI 기능

### Gemini API 통합
- **지원 모델**:
  - `gemini-pro`: 고급 추론 및 생성
  - `gemini-flash`: 빠른 응답과 좋은 품질
- **API 키 관리**:
  - 서버 측 키를 위한 환경 변수 지원
  - 할당량 추적과 함께 클라이언트 측 API 키 저장
  - 하나의 키가 제한에 도달했을 때 자동 키 전환
- **요청 매개변수**:
  - 대화 문맥을 유지하기 위한 문맥 요약
  - 캐릭터 성격 및 행동 패턴
  - 사용자 노트 및 기본 설정
  - 키워드 매칭을 포함한 활성 로어북
  - 출력 토큰 제한 및 생각 예산

### 안전성과 보안 기능
- **할당량 관리**: 자동 할당량 추적과 일시적 차단
- **속도 제한**: API 남용 방지를 위한 내장 보호
- **안전한 키 처리**: 할당량 추적과 함께 클라이언트 측 키 관리
- **콘텐츠 필터링**: 캐릭터별 안전 규칙

### 고급 AI 기능
- **문맥 윈도우 관리**: 대화 요약을 유지하기 위한 자동 요약
- **로어북 시스템**: 키워드 감지를 통한 동적 지식 베이스
- **성격 일관성**: 대화 간 캐릭터 행동 유지
- **메모리 시스템**: 장기 문맥 보존

## 캐릭터 관리 시스템

### 캐릭터 생성
- **필수 필드**:
  - 캐릭터 이름과 성격 설명
  - 1인칭(나/우리)과 2인칭(너) 대명사
  - 대화 스타일(사적인/공적인 등)
  - 관계 유형(친구, 멘토 등)
- **선택적 필드**:
  - 배경 스토리
  - 성격 특징 (태그)
  - 안전 규칙
  - 아바타 (플레이스홀더)

### 캐릭터 속성
- **개인화**: 상세한 성격과 행동 패턴
- **대화 스타일**: 사용자 정의 1인칭/2인칭 대명사
- **관계 문맥**: 사용자와의 관계 정의
- **스타일 설정**: 정중함 및 대화 어조
- **특성 태그**: 간결한 성격 식별자

### 캐릭터 사용
- **동적 로드**: 활성 대화에 캐릭터 로드 가능
- **성격 주입**: 캐릭터 세부정보를 AI 프롬프트에 삽입
- **문맥 통합**: 캐릭터 성격이 모든 응답에 영향
- **관계 인식**: 캐릭터는 사용자와의 관계를 기억

## 채팅 기록 및 메모리 시스템

### 메모리 관리
- **자동 요약**: 주기적인 문맥 요약 (20개 메시지/10턴마다)
- **수동 요약**: 중요한 대화를 위한 사용자 시작 요약
- **문맥 보존**: 세션 간 장기 대화 메모리
- **효율적인 저장**: 최적화된 로컬 저장소 사용

### 채팅 기록 기능
- **페이지네이션**: 10개 단위로 이전 메시지 로드
- **메모리 최적화**: 최대 50개 메시지를 한 번에 메모리에 유지
- **선택적 로드**: 최근 10개 메시지만 활성 메모리에 유지
- **전체 기록 액세스**: 로컬 저장소를 통해 전체 대화 기록 접근 가능

### 데이터 지속성
- **로컬 저장소**: 모든 채팅 기록을 브라우저의 로컬 저장소에 저장
- **동기화**: UI 상태와 저장소 간 실시간 동기화
- **디바운싱**: 저장 작업을 줄이기 위한 500ms 지연
- **메타데이터 관리**: 효율적인 기록 목록을 위한 별도 요약

## UI 기능 및 모바일 지원

### 데스크톱 인터페이스
- **3패널 레이아웃**: 사이드바, 채팅 영역, 설정 패널
- **조절 가능한 패널**: 조정 가능한 설정 패널 너비
- **사이드바 네비게이션**: 캐릭터 및 기록 관리
- **고급 설정**: 오른쪽 패널의 포괄적 구성

### 모바일 인터페이스
- **하단 네비게이션**: 핵심 기능을 위한 탭 기반 네비게이션
- **드로어 시스템**: 캐릭터, 기록, 설정을 위한 슬라이드 아웃 패널
- **반응형 디자인**: 최적화된 터치 상호작용
- **모바일 우선 컴포넌트**: 특별히 설계된 모바일 채팅 인터페이스

### UI 커스터마이징
- **스타일 테마**: 모던 또는 클래식 인터페이스 옵션
- **자동 스크롤 제어**: 자동 스크롤 동작 구성 가능
- **시각적 피드백**: 로딩 상태, 오류 처리 및 성공 표시
- **접근성**: 적절한 키보드 네비게이션 및 스크린 리더 지원

## 설치 및 설정 프로세스

### 사전 요구 사항
- Node.js (Next.js 16과 호환되는 버전)
- npm 또는 yarn 패키지 관리자
- Google Gemini API 키

### 설정 단계

1. **복제 및 종속성 설치**
```bash
npm install
```

2. **환경 구성**
프로젝트 루트에 `.env.local` 파일 생성:
```env
GOOGLE_GEMINI_API_KEY=API_키
GOOGLE_GEMINI_API_KEY_2=선택_2_번째_키
GOOGLE_GEMINI_API_KEY_3=선택_3_번째_키
GOOGLE_GEMINI_API_KEY_4=선택_4_번째_키
GOOGLE_GEMINI_API_KEY_5=선택_5_번째_키
```

3. **개발 서버 실행**
```bash
npm run dev
```

4. **애플리케이션 액세스**
브라우저에서 `http://localhost:3000` 방문

### 구성 옵션
- **API 키**: 자동 장애 조치를 위한 다중 API 키 추가
- **환경 변수**: 환경 변수를 통한 모든 설정 구성
- **사용자 정의 캐릭터**: 자체 캐릭터 생성 또는 기본 셋 사용

### 프로덕션 배포
애플리케이션은 표준 Next.js 배포 방법을 지원:
- Vercel (권장)
- Netlify
- 모든 Node.js 호스팅 플랫폼
- 정적 내보내기 (수정 사항과 함께)

## 추가 기능

### PWA 지원
- 오프라인 기능
- 설치 가능한 애플리케이션
- 푸시 알림 (구현된 경우)
- 모바일 앱과 유사한 경험

### 데이터 내보내기/가져오기
- 전체 데이터 백업 기능
- JSON 기반 내보내기 형식
- 브라우저/장치 간의 쉬운 데이터 마이그레이션
- 모든 캐릭터, 대화, 설정의 백업

### 고급 설정
- 출력 속도 제어 (즉시, 빠르게, 느리게)
- 토큰 제한 사용자 지정
- 생각 예산 조정
- 로어북 관리
- UI 스타일 전환

이 포괄적인 문서는 AI 캐릭터 채팅 애플리케이션의 핵심 측면을 다루며, 기능, 아키텍처 및 사용법에 대한 전체 이해를 제공합니다.